     1                                  global _start           ;делаем метку видимой извне
     2                                  
     3                                  section .data                         ; секция с данными
     4 00000000 456E74657220737472-         input_msg db "Enter string: ", 0  ; сообщение для ввода
     4 00000009 696E673A2000       
     5                                      len_in_msg equ $ - input_msg      ; длина сообщения
     6 0000000F 526576657273656420-         out_msg db "Reversed string: ", 0 ; сообщение для вывода
     6 00000018 737472696E673A2000 
     7                                      len_out_msg equ $ - out_msg       ; длина сообщения
     8 00000021 0000000000000000            len_read dq 0                     ; количество считанных байт
     9                                  
    10                                  section .bss                       ; секция bss для неинициализированных данных
    11 00000000 <res 80h>                   buffer resb 128                ; буфер для считывания из стандартного ввода
    12 00000080 <res 80h>                   reversed resb 128              ; буфер для перевернутой строки
    13                                  
    14                                  section .text                       ; объявление секции кода
    15                                  _start:                             ; точка входа в программу
    16 00000000 B801000000                  mov rax, 1                      ; 1 - номер системного вызова функции write
    17 00000005 BF01000000                  mov rdi, 1                      ; 1 - дескриптор файла стандартного вызова stdout
    18 0000000A 48BE-                       mov rsi, input_msg              ; адрес строки для вывода
    18 0000000C [0000000000000000] 
    19 00000014 BA0F000000                  mov rdx, len_in_msg             ; кол-во байт которое нужно записать
    20 00000019 0F05                        syscall                         ; выполняем системный вызов write
    21                                  
    22 0000001B 4883F8FF                    cmp rax, -1                     ; сравниваем значение которое вернул write
    23 0000001F 0F84C0000000                jz err                          ; если rax = -1 то переход на метку err
    24                                  
    25 00000025 B800000000                  mov rax, 0                      ; номер системного вызова read
    26 0000002A 48BE-                       mov rsi, buffer                 ; сообщение для записи
    26 0000002C [0000000000000000] 
    27 00000034 BF00000000                  mov rdi, 0                      ; дескриптор STDIN
    28 00000039 BA80000000                  mov rdx, 128                    ; длина считываемого сообщения
    29 0000003E 0F05                        syscall                         ; выполняем системный вызов read
    30                                  
    31 00000040 48890425[21000000]          mov [len_read], rax              ; количество байтов которые были прочитаны
    32 00000048 4883F8FF                    cmp rax, -1                      ; сравниваем значение которое вернул read
    33 0000004C 0F8493000000                jz err                           ; если rax = -1 то переход на метку err
    34                                  
    35 00000052 E84B000000                  call reverse                    ; вызов функции переворота строки
    36                                  
    37 00000057 B801000000                  mov rax, 1                      ; 1 - номер системного вызова функции write
    38 0000005C BF01000000                  mov rdi, 1                      ; 1 - дескриптор файла стандартного вызова stdout
    39 00000061 48BE-                       mov rsi, out_msg                ; адрес строки для вывода
    39 00000063 [0F00000000000000] 
    40 0000006B BA12000000                  mov rdx, len_out_msg            ; кол-во байт которое нужно записать
    41 00000070 0F05                        syscall                         ; выполняем системный вызов write
    42                                  
    43 00000072 4883F8FF                    cmp rax, -1                     ; сравниваем значение которое вернул write
    44 00000076 746D                        jz err                          ; если rax = -1 то переход на метку err
    45                                  
    46 00000078 B801000000                  mov rax, 1                      ; 1 - номер системного вызова функции write
    47 0000007D BF01000000                  mov rdi, 1                      ; 1 - дескриптор файла стандартного вызова stdout
    48 00000082 48BE-                       mov rsi, reversed               ; адрес строки для вывода
    48 00000084 [8000000000000000] 
    49 0000008C 488B1425[21000000]          mov rdx, [len_read]             ; кол-во байт которое нужно записать
    50 00000094 4883C202                    add rdx, 2                      ; перевод строки и нуль-терминатор
    51 00000098 0F05                        syscall                         ; выполняем системный вызов write
    52                                  
    53 0000009A 4883F8FF                    cmp rax, -1                     ; сравниваем значение которое вернул write
    54 0000009E 7445                        jz err                          ; если rax = length то переход на метку success
    55 000000A0 EB37                        jmp success                     ; иначе на метку err
    56                                  
    57                                  ; функция для переворота строки
    58                                  reverse:
    59 000000A2 488B0C25[21000000]          mov rcx, [len_read]       ; инициализируем счетчик длиной строки
    60                                      
    61 000000AA 48BE-                       mov rsi, buffer           ; начало исходной строки
    61 000000AC [0000000000000000] 
    62 000000B4 48BF-                       mov rdi, reversed         ; начало перевернутой строки
    62 000000B6 [8000000000000000] 
    63 000000BE 4801CE                      add rsi, rcx              ; перемещаемся в конец исходной строки
    64 000000C1 4883EE02                    sub rsi, 2                ; последний символ (не перевод строки)
    65                                  
    66                                      strloop:                      ; цикл прохода по строке
    67 000000C5 8A06                            mov al, [rsi]             
    68 000000C7 8807                            mov [rdi], al
    69 000000C9 48FFCE                          dec rsi                   ; двигаемся назад по исходной строке
    70 000000CC 48FFC7                          inc rdi                   ; двигаемся вперед по перевернутой строке
    71 000000CF E2F4                            loop strloop              ; уменьшаем счетчик rcx и переходим на метку strloop, если rcx != 0
    72                                      
    73 000000D1 C6070A                      mov byte [rdi], 10        ; добавление в конец перевода строки
    74 000000D4 C6470100                    mov byte [rdi+1], 0       ; добавление в конец нуль-терминатора
    75 000000D8 C3                          ret                       ; выход из функции
    76                                  
    77                                  ; успешное завершение программы
    78                                  success:   
    79 000000D9 B83C000000                  mov rax, 60                    ; 60 - номер системного вызова exit         
    80 000000DE BF00000000                  mov rdi, 0
    81 000000E3 0F05                        syscall                        ; выполняем системный вызов exit
    82                                  
    83                                  ; завершение программы с ошибкой
    84                                  err:
    85 000000E5 B83C000000                  mov rax, 60                    ; 60 - номер системного вызова exit
    86 000000EA 48C7C7FFFFFFFF              mov rdi, -1
    87 000000F1 0F05                        syscall                        ; выполняем системный вызов exit
